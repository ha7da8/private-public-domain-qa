import{j as me,r as d,a as Ie}from"./react-a9b6c34a.js";import{a as Ee,c as Be}from"./react-dom-a06df840.js";import{L as Me,N as ie,H as De}from"./react-router-dom-e5f3a2d5.js";import{O as qe,d as $e,e as J}from"./react-router-0030e45b.js";import{S as Ce,A as Se,a as Qe,R as X,b as je,C as Oe,c as Fe}from"./microsoft-cognitiveservices-speech-sdk-6e793f52.js";import{p as fe}from"./dompurify-76a5efca.js";import{S as ze,a as k,I as ce,E as He,P as Ge,T as z,B as Ue,b as Ke,c as Ve,d as le,e as We,f as ve,g as Je,h as ye,D as be,C as Xe,i as Ne,j as W,k as Ye,l as Ze,m as et,n as tt}from"./@fluentui-b922d453.js";import{J as nt,i as ot}from"./@react-spring-3be8f457.js";import"./bent-d4cce1f4.js";import"./@remix-run-88f74c5a.js";import"./uuid-a960c1f4.js";import"./tslib-14a4c710.js";import"./@microsoft-31b40247.js";import"./@griffel-cbe60fd0.js";import"./rtl-css-js-4ed993c7.js";import"./@emotion-8a8e73f6.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();const he=me.Fragment,e=me.jsx,h=me.jsxs;const at="/assets/github-fab00c2d.svg",st="_layout_1nrkm_1",rt="_header_1nrkm_7",it="_headerContainer_1nrkm_12",ct="_headerTitleContainer_1nrkm_20",lt="_headerLogo_1nrkm_28",ut="_headerTitle_1nrkm_20",dt="_headerNavList_1nrkm_37",ht="_headerNavPageLink_1nrkm_43",pt="_headerNavPageLinkActive_1nrkm_57",mt="_headerNavLeftMargin_1nrkm_62",gt="_headerRightText_1nrkm_66",_t="_microsoftLogo_1nrkm_71",Ct="_githubLogo_1nrkm_76",y={layout:st,header:rt,headerContainer:it,headerTitleContainer:ct,headerLogo:lt,headerTitle:ut,headerNavList:dt,headerNavPageLink:ht,headerNavPageLinkActive:pt,headerNavLeftMargin:mt,headerRightText:gt,microsoftLogo:_t,githubLogo:Ct},St=()=>h("div",{className:y.layout,children:[e("header",{className:y.header,role:"banner",children:h("div",{className:y.headerContainer,children:[e(Me,{to:"/",className:y.headerTitleContainer,children:e("h3",{className:y.headerTitle,children:"GPT + Enterprise data | Sample"})}),e("nav",{children:h("ul",{className:y.headerNavList,children:[e("li",{children:e(ie,{to:"/",className:({isActive:t})=>t?y.headerNavPageLinkActive:y.headerNavPageLink,children:"Chat"})}),e("li",{className:y.headerNavLeftMargin,children:e(ie,{to:"/qa",className:({isActive:t})=>t?y.headerNavPageLinkActive:y.headerNavPageLink,children:"Ask a question"})}),e("li",{className:y.headerNavLeftMargin,children:e(ie,{to:"/files",className:({isActive:t})=>t?y.headerNavPageLinkActive:y.headerNavPageLink,children:"Files Viewer"})}),e("li",{className:y.headerNavLeftMargin,children:e("a",{href:"https://aka.ms/entgptsearch",target:"_blank",title:"Github repository link",children:e("img",{src:at,alt:"Github logo","aria-label":"Link to github repository",width:"20px",height:"20px",className:y.githubLogo})})})]})}),e("h4",{className:y.headerRightText,children:"Azure OpenAI + Cognitive Search"})]})}),e(qe,{})]}),ft=()=>e("h1",{children:"404"}),vt="_oneshotContainer_p6613_1",yt="_oneshotTopSection_p6613_8",bt="_oneshotBottomSection_p6613_15",Nt="_oneshotTitle_p6613_25",kt="_oneshotQuestionInput_p6613_39",Tt="_oneshotAnswerContainer_p6613_46",wt="_oneshotAnalysisPanel_p6613_53",xt="_oneshotSettingsSeparator_p6613_58",Rt="_settingsButton_p6613_62",b={oneshotContainer:vt,oneshotTopSection:yt,oneshotBottomSection:bt,oneshotTitle:Nt,oneshotQuestionInput:kt,oneshotAnswerContainer:Tt,oneshotAnalysisPanel:wt,oneshotSettingsSeparator:xt,settingsButton:Rt};async function At(t){var i,n,s,p,f,r,C,l;const o=await fetch("/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t.question,approach:t.approach,overrides:{semantic_ranker:(i=t.overrides)==null?void 0:i.semanticRanker,semantic_captions:(n=t.overrides)==null?void 0:n.semanticCaptions,top:(s=t.overrides)==null?void 0:s.top,temperature:(p=t.overrides)==null?void 0:p.temperature,prompt_template:(f=t.overrides)==null?void 0:f.promptTemplate,prompt_template_prefix:(r=t.overrides)==null?void 0:r.promptTemplatePrefix,prompt_template_suffix:(C=t.overrides)==null?void 0:C.promptTemplateSuffix,exclude_category:(l=t.overrides)==null?void 0:l.excludeCategory}})}),a=await o.json();if(o.status>299||!o.ok)throw Error(a.error||"Unknown error");return a}async function Lt(t){var i,n,s,p,f,r,C,l,m;const o=await fetch("/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({history:t.history,approach:t.approach,overrides:{semantic_ranker:(i=t.overrides)==null?void 0:i.semanticRanker,semantic_captions:(n=t.overrides)==null?void 0:n.semanticCaptions,top:(s=t.overrides)==null?void 0:s.top,temperature:(p=t.overrides)==null?void 0:p.temperature,prompt_template:(f=t.overrides)==null?void 0:f.promptTemplate,prompt_template_prefix:(r=t.overrides)==null?void 0:r.promptTemplatePrefix,prompt_template_suffix:(C=t.overrides)==null?void 0:C.promptTemplateSuffix,exclude_category:(l=t.overrides)==null?void 0:l.excludeCategory,suggest_followup_questions:(m=t.overrides)==null?void 0:m.suggestFollowupQuestions}})}),a=await o.json();if(o.status>299||!o.ok)throw Error(a.error||"Unknown error");return a}async function Pt(t){const o="e985cb0392ad45d59681a396b208ebcf",a="southcentralus";var i=Ce.fromSubscription(o,a);const n=Se.fromDefaultSpeakerOutput();i.speechSynthesisVoiceName="zh-CN-YunxiNeural";const s=new Qe(i,n),f=t.answer.replace(/\[[^\]]*\]/g,"");console.log(t.answer),s.speakTextAsync(f,function(r){r.reason===X.SynthesizingAudioCompleted?console.log("synthesis finished."):console.error("Speech synthesis canceled, "+r.errorDetails+`
Did you set the speech resource key and region values?`),s.close()},function(r){console.trace("err - "+r),s.close()})}function It(t){return`/content/${t}`}var I=(t=>(t.RetrieveThenRead="rtr",t.ReadRetrieveRead="rrr",t.ReadDecomposeAsk="rda",t))(I||{});const Et="_answerContainer_9j9bn_1",Bt="_answerLogo_9j9bn_9",Mt="_answerText_9j9bn_13",Dt="_selected_9j9bn_22",qt="_citationLearnMore_9j9bn_26",$t="_citation_9j9bn_26",Qt="_followupQuestionsList_9j9bn_48",jt="_followupQuestionLearnMore_9j9bn_52",Ot="_followupQuestion_9j9bn_48",Ft="_supContainer_9j9bn_71",zt="_retryButton_9j9bn_100",Ht="_loadingdots_9j9bn_122",Gt="_loading_9j9bn_122",N={answerContainer:Et,answerLogo:Bt,answerText:Mt,selected:Dt,citationLearnMore:qt,citation:$t,followupQuestionsList:Qt,followupQuestionLearnMore:jt,followupQuestion:Ot,supContainer:Ft,retryButton:zt,loadingdots:Ht,loading:Gt};function Ut(t,o){const a=[],i=[];let n=t.replace(/<<([^>>]+)>>/g,(r,C)=>(i.push(C),""));n=n.trim();const s=n.split(/\[([^\]]+)\]+\(([^\)]+)\)/g);console.log(s);let p=n.match(/\[([^\]]+)\]+\(([^\)]+)\)/g);return console.log(p),p&&p.map((r,C)=>{const l=r.split("]")[0].replace("[",""),m=r.split("]")[1].replace("(","").replace(")","");console.log(l),console.log(m),a.push({id:C,name:l,path:m})}),{answerHtml:s.map((r,C)=>{if(C%3===0)return r;if(C%3==1){let l=a.find(B=>B.name==r),m=l?l.id:-1;m!==-1?m=l?l.id+1:-1:m=a.length;const v=It(r);return Ee(e("a",{className:"supContainer",title:r,onClick:()=>o(v),children:e("sup",{children:m})}))}else return""}).join(""),citations:a,followupQuestions:i}}const ke=()=>e(ze,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),Te=({answer:t,isSelected:o,onCitationClicked:a,onThoughtProcessClicked:i,onSupportingContentClicked:n,onFollowupQuestionClicked:s,onReadAnswerClicked:p,showFollowupQuestions:f})=>{const r=d.useMemo(()=>Ut(t.answer,a),[t]),C=fe.sanitize(r.answerHtml);return h(k,{className:`${N.answerContainer} ${o&&N.selected}`,verticalAlign:"space-between",children:[e(k.Item,{children:h(k,{horizontal:!0,horizontalAlign:"space-between",children:[e(ke,{}),h("div",{children:[e(ce,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>i(),disabled:!t.thoughts}),e(ce,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>n(),disabled:!t.data_points.length}),e(ce,{style:{color:"black"},iconProps:{iconName:"ReadOutLoud"},title:"Read answer",ariaLabel:"Read answer",onClick:()=>p(),disabled:!t.answer})]})]})}),e(k.Item,{grow:!0,children:e("div",{className:N.answerText,dangerouslySetInnerHTML:{__html:C}})}),!!r.citations.length&&e(k.Item,{children:h(k,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e("span",{className:N.citationLearnMore,children:"来源:"}),r.citations.map((l,m)=>{const v=l.path;return e("a",{className:N.citation,title:l.name,onClick:()=>a(v),children:`${++m}. ${l.name}`},m)})]})}),!!r.followupQuestions.length&&f&&s&&e(k.Item,{children:h(k,{horizontal:!0,wrap:!0,className:`${r.citations.length?N.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e("span",{className:N.followupQuestionLearnMore,children:"您可能还想问:"}),r.followupQuestions.map((l,m)=>e("a",{className:N.followupQuestion,title:l,onClick:()=>s(l),children:`${l}`},m))]})})]})},Kt=()=>{const t=nt({from:{opacity:0},to:{opacity:1}});return e(ot.div,{style:{...t},children:h(k,{className:N.answerContainer,verticalAlign:"space-between",children:[e(ke,{}),e(k.Item,{grow:!0,children:h("p",{className:N.answerText,children:["正在生成回答",e("span",{className:N.loadingdots})]})})]})})},we=({error:t,onRetry:o})=>h(k,{className:N.answerContainer,verticalAlign:"space-between",children:[e(He,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e(k.Item,{grow:!0,children:e("p",{className:N.answerText,children:t})}),e(Ge,{className:N.retryButton,onClick:o,text:"Retry"})]}),Vt="_questionInputContainer_sk61p_1",Wt="_questionInputTextArea_sk61p_10",Jt="_questionInputButtonsContainer_sk61p_15",Xt="_questionInputSendButton_sk61p_21",Yt="_questionInputSendButtonDisabled_sk61p_25",F={questionInputContainer:Vt,questionInputTextArea:Wt,questionInputButtonsContainer:Jt,questionInputSendButton:Xt,questionInputSendButtonDisabled:Yt},xe=({onSend:t,disabled:o,placeholder:a,clearOnSend:i})=>{const[n,s]=d.useState(""),p=()=>{if(o||!n.trim()){console.log("send disabled"),console.log("question: "+n);return}t(n),i&&s("")},f=()=>{const m="e985cb0392ad45d59681a396b208ebcf",v="southcentralus";var B=Ce.fromSubscription(m,v);const T=Se.fromDefaultMicrophoneInput();B.speechRecognitionLanguage="zh-CN";const Q=new je(B,T);Q.recognizeOnceAsync(w=>{switch(w.reason){case X.RecognizedSpeech:console.log(`RECOGNIZED: Text=${w.text}`),s(w.text);break;case X.NoMatch:console.log("NOMATCH: Speech could not be recognized.");break;case X.Canceled:const L=Oe.fromResult(w);console.log(`CANCELED: Reason=${L.reason}`),L.reason==Fe.Error&&(console.log(`CANCELED: ErrorCode=${L.ErrorCode}`),console.log(`CANCELED: ErrorDetails=${L.errorDetails}`),console.log("CANCELED: Did you set the speech resource key and region values?"));break}Q.close()})},r=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),p())},C=(m,v)=>{v?v.length<=1e3&&s(v):s("")},l=o||!n.trim();return h(k,{horizontal:!0,className:F.questionInputContainer,children:[e(z,{className:F.questionInputTextArea,placeholder:a,multiline:!0,resizable:!1,borderless:!0,value:n,onChange:C,onKeyDown:r}),h("div",{className:F.questionInputButtonsContainer,children:[e("div",{className:`${F.questionInputSendButton} ${l?F.questionInputSendButtonDisabled:""}`,"aria-label":"语音输入",onClick:f,children:e(Ue,{primaryFill:"rgba(115, 118, 225, 1)"})}),e("div",{className:`${F.questionInputSendButton} ${l?F.questionInputSendButtonDisabled:""}`,"aria-label":"提问按钮",onClick:p,children:e(Ke,{primaryFill:"rgba(115, 118, 225, 1)"})})]})]})},Zt="_examplesNavList_1eu46_1",en="_example_1eu46_1",tn="_exampleText_1eu46_27",pe={examplesNavList:Zt,example:en,exampleText:tn},nn=({text:t,value:o,onClick:a})=>e("div",{className:pe.example,onClick:()=>a(o),children:e("p",{className:pe.exampleText,children:t})}),on=[{text:"正常DMS计算公式是什么?",value:"正常DMS计算公式是什么?"},{text:"进货未销定义是什么?",value:"进货未销定义?"},{text:"APP与OSPC端门店货源查询退货状态不一致 门店商品退货状态系统逻辑?",value:"APP与OSPC端门店货源查询退货状态不一致 门店商品退货状态系统逻辑?"}],Re=({onExampleClicked:t})=>e("ul",{className:pe.examplesNavList,children:on.map((o,a)=>e("li",{children:e(nn,{text:o.text,value:o.value,onClick:t})},a))}),an="_thoughtProcess_1rdxk_1",sn={thoughtProcess:an};function rn(t){const o=t.split(": "),a=o[0];var i=o.slice(1).join(": ")?o.slice(1).join(": "):"No content";const n=i.match(/<([^>]+)>/);return i=i.replace(/<([^>]+)>/g,""),{title:a,content:i,url:n?n[1]:""}}const cn="_supportingContentNavList_1yfye_1",ln="_supportingContentItem_1yfye_9",un="_supportingContentItemHeader_1yfye_21",dn="_supportingContentItemText_1yfye_25",V={supportingContentNavList:cn,supportingContentItem:ln,supportingContentItemHeader:un,supportingContentItemText:dn},hn=({supportingContent:t})=>e("ul",{className:V.supportingContentNavList,children:t.map((o,a)=>{const i=rn(o);return h("li",{className:V.supportingContentItem,children:[e("h4",{className:V.supportingContentItemHeader,children:i.title}),e("p",{className:V.supportingContentItemText,children:i.content}),e("a",{className:V.supportingContentItemText,href:i.url,target:"_blank",children:i.url})]})})});var x=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(x||{});const ue={disabled:!0,style:{color:"grey"}},Ae=({answer:t,activeTab:o,activeCitation:a,citationHeight:i,className:n,onActiveTabChanged:s})=>{const p=!t.thoughts,f=!t.data_points.length,r=!a,C=fe.sanitize(t.thoughts);return h(Ve,{className:n,selectedKey:o,onLinkClick:l=>l&&s(l.props.itemKey),children:[e(le,{itemKey:x.ThoughtProcessTab,headerText:"思维过程",headerButtonProps:p?ue:void 0,children:e("div",{className:sn.thoughtProcess,dangerouslySetInnerHTML:{__html:C}})}),e(le,{itemKey:x.SupportingContentTab,headerText:"支持内容",headerButtonProps:f?ue:void 0,children:e(hn,{supportingContent:t.data_points})}),e(le,{itemKey:x.CitationTab,headerText:"引用",headerButtonProps:r?ue:void 0,children:e("iframe",{title:"引用",src:a,width:"100%",height:i})})]})},pn="_container_cfwv2_1",mn={container:pn},Le=({className:t,onClick:o})=>h("div",{className:`${mn.container} ${t??""}`,onClick:o,children:[e(We,{}),e(ve,{children:"开发人员配置"})]}),gn=()=>{const[t,o]=d.useState(!1),[a,i]=d.useState(I.ReadDecomposeAsk),[n,s]=d.useState(""),[p,f]=d.useState(""),[r,C]=d.useState(""),[l,m]=d.useState(3),[v,B]=d.useState(!1),[T,Q]=d.useState(!1),[w,L]=d.useState(""),M=d.useRef(""),[D,G]=d.useState(!1),[q,$]=d.useState(),[R,j]=d.useState(),[H,E]=d.useState(),[O,P]=d.useState(void 0),U=async g=>{M.current=g,q&&$(void 0),G(!0),E(void 0),P(void 0);try{const _={question:g,approach:a,overrides:{promptTemplate:n.length===0?void 0:n,promptTemplatePrefix:p.length===0?void 0:p,promptTemplateSuffix:r.length===0?void 0:r,excludeCategory:w.length===0?void 0:w,top:l,semanticRanker:v,semanticCaptions:T}},Pe=await At(_);j(Pe)}catch(_){$(_)}finally{G(!1)}},Y=(g,_)=>{s(_||"")},Z=(g,_)=>{f(_||"")},ee=(g,_)=>{C(_||"")},te=(g,_)=>{m(parseInt(_||"3"))},ne=(g,_)=>{i((_==null?void 0:_.key)||I.RetrieveThenRead)},oe=(g,_)=>{B(!!_)},ae=(g,_)=>{Q(!!_)},se=(g,_)=>{L(_||"")},K=g=>{U(g)},re=g=>{H===g&&O===x.CitationTab?P(void 0):(E(g),P(x.CitationTab))},c=g=>{P(O===g?void 0:g)},u=()=>{alert("onReadAnswerClicked")},A=[{key:I.RetrieveThenRead,text:"Retrieve-Then-Read"},{key:I.ReadRetrieveRead,text:"Read-Retrieve-Read"},{key:I.ReadDecomposeAsk,text:"Read-Decompose-Ask"}];return h("div",{className:b.oneshotContainer,children:[h("div",{className:b.oneshotTopSection,children:[e(Le,{className:b.settingsButton,onClick:()=>o(!t)}),e("h1",{className:b.oneshotTitle,children:"Ask your data"}),e("div",{className:b.oneshotQuestionInput,children:e(xe,{placeholder:"示例:面条是否可以用体外模拟进行GI测试？?",disabled:D,onSend:g=>U(g)})})]}),h("div",{className:b.oneshotBottomSection,children:[D&&e(Je,{label:"正在生成回答"}),!M.current&&e(Re,{onExampleClicked:K}),!D&&R&&!q&&e("div",{className:b.oneshotAnswerContainer,children:e(Te,{answer:R,onCitationClicked:g=>re(g),onThoughtProcessClicked:()=>c(x.ThoughtProcessTab),onSupportingContentClicked:()=>c(x.SupportingContentTab),onReadAnswerClicked:()=>u()})}),q?e("div",{className:b.oneshotAnswerContainer,children:e(we,{error:q.toString(),onRetry:()=>U(M.current)})}):null,O&&R&&e(Ae,{className:b.oneshotAnalysisPanel,activeCitation:H,onActiveTabChanged:g=>c(g),citationHeight:"600px",answer:R,activeTab:O})]}),h(ye,{headerText:"配置",isOpen:t,isBlocking:!1,onDismiss:()=>o(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e(be,{onClick:()=>o(!1),children:"Close"}),isFooterAtBottom:!0,children:[e(Xe,{className:b.oneshotSettingsSeparator,label:"方式",options:A,defaultSelectedKey:a,onChange:ne}),(a===I.RetrieveThenRead||a===I.ReadDecomposeAsk)&&e(z,{className:b.oneshotSettingsSeparator,defaultValue:n,label:"更改提问模板",multiline:!0,autoAdjustHeight:!0,onChange:Y}),a===I.ReadRetrieveRead&&h(he,{children:[e(z,{className:b.oneshotSettingsSeparator,defaultValue:p,label:"更改提问前缀模板",multiline:!0,autoAdjustHeight:!0,onChange:Z}),e(z,{className:b.oneshotSettingsSeparator,defaultValue:r,label:"更改提问后缀模板",multiline:!0,autoAdjustHeight:!0,onChange:ee})]}),e(Ne,{className:b.oneshotSettingsSeparator,label:"最多从搜索中返回的条目数量:",min:1,max:50,defaultValue:l.toString(),onChange:te}),e(z,{className:b.oneshotSettingsSeparator,label:"排除类别",onChange:se}),e(W,{className:b.oneshotSettingsSeparator,checked:v,label:"使用语义搜索",onChange:oe}),e(W,{className:b.oneshotSettingsSeparator,checked:T,label:"使用查询上下文摘要而不是整个文档",onChange:ae,disabled:!v})]})]})},_n="_container_18ti9_1",Cn="_chatRoot_18ti9_8",Sn="_chatContainer_18ti9_13",fn="_chatEmptyState_18ti9_21",vn="_chatEmptyStateTitle_18ti9_31",yn="_chatEmptyStateSubtitle_18ti9_38",bn="_chatMessageStream_18ti9_54",Nn="_chatMessageGpt_18ti9_66",kn="_chatMessageGptMinWidth_18ti9_73",Tn="_chatInput_18ti9_78",wn="_chatAnalysisPanel_18ti9_91",xn="_chatSettingsSeparator_18ti9_99",Rn="_loadingLogo_18ti9_103",An="_commandsContainer_18ti9_107",Ln="_commandButton_18ti9_112",S={container:_n,chatRoot:Cn,chatContainer:Sn,chatEmptyState:fn,chatEmptyStateTitle:vn,chatEmptyStateSubtitle:yn,chatMessageStream:bn,chatMessageGpt:Nn,chatMessageGptMinWidth:kn,chatInput:Tn,chatAnalysisPanel:wn,chatSettingsSeparator:xn,loadingLogo:Rn,commandsContainer:An,commandButton:Ln},Pn="_container_1rakl_1",In="_message_1rakl_9",ge={container:Pn,message:In},de=({message:t})=>e("div",{className:ge.container,children:e("div",{className:ge.message,children:t})}),En="_container_1opm5_1",Bn="_disabled_1opm5_8",_e={container:En,disabled:Bn},Mn=({className:t,disabled:o,onClick:a})=>h("div",{className:`${_e.container} ${t??""} ${o&&_e.disabled}`,onClick:a,children:[e(Ye,{}),e(ve,{children:"清空对话"})]}),Dn=()=>{const[t,o]=d.useState(!1),[a,i]=d.useState(""),[n,s]=d.useState(3),[p,f]=d.useState(!1),[r,C]=d.useState(!1),[l,m]=d.useState(""),[v,B]=d.useState(!0),T=d.useRef(""),Q=d.useRef(null),[w,L]=d.useState(!1),[M,D]=d.useState(),[G,q]=d.useState(),[$,R]=d.useState(void 0),[j,H]=d.useState(0),[E,O]=d.useState([]),P=async c=>{T.current=c,M&&D(void 0),L(!0),q(void 0),R(void 0);try{const A={history:[...E.map(_=>({user:_[0],bot:_[1].answer})),{user:c,bot:void 0}],approach:I.ReadRetrieveRead,overrides:{promptTemplate:a.length===0?void 0:a,excludeCategory:l.length===0?void 0:l,top:n,semanticRanker:p,semanticCaptions:r,suggestFollowupQuestions:v}},g=await Lt(A);O([...E,[c,g]])}catch(u){D(u)}finally{L(!1)}},U=()=>{T.current="",M&&D(void 0),q(void 0),R(void 0),O([])};d.useEffect(()=>{var c;return(c=Q.current)==null?void 0:c.scrollIntoView({behavior:"smooth"})},[w]);const Y=(c,u)=>{i(u||"")},Z=(c,u)=>{s(parseInt(u||"3"))},ee=(c,u)=>{f(!!u)},te=(c,u)=>{C(!!u)},ne=(c,u)=>{m(u||"")},oe=(c,u)=>{B(!!u)},ae=c=>{P(c)},se=(c,u)=>{G===c&&$===x.CitationTab&&j===u?R(void 0):(q(c),R(x.CitationTab)),H(u)},K=(c,u)=>{R($===c&&j===u?void 0:c),H(u)},re=async(c,u)=>{H(u);try{const A={answer:c.answer};await Pt(A)}catch(A){D(A)}finally{L(!1)}};return h("div",{className:S.container,children:[h("div",{className:S.commandsContainer,children:[e(Mn,{className:S.commandButton,onClick:U,disabled:!T.current||w}),e(Le,{className:S.commandButton,onClick:()=>o(!t)})]}),h("div",{className:S.chatRoot,children:[h("div",{className:S.chatContainer,children:[T.current?h("div",{className:S.chatMessageStream,children:[E.map((c,u)=>h("div",{children:[e(de,{message:c[0]}),e("div",{className:S.chatMessageGpt,children:e(Te,{answer:c[1],isSelected:j===u&&$!==void 0,onCitationClicked:A=>se(A,u),onThoughtProcessClicked:()=>K(x.ThoughtProcessTab,u),onSupportingContentClicked:()=>K(x.SupportingContentTab,u),onFollowupQuestionClicked:A=>P(A),onReadAnswerClicked:()=>re(c[1],u),showFollowupQuestions:v&&E.length-1===u},u)})]},u)),w&&h(he,{children:[e(de,{message:T.current}),e("div",{className:S.chatMessageGptMinWidth,children:e(Kt,{})})]}),M?h(he,{children:[e(de,{message:T.current}),e("div",{className:S.chatMessageGptMinWidth,children:e(we,{error:M.toString(),onRetry:()=>P(T.current)})})]}):null,e("div",{ref:Q})]}):h("div",{className:S.chatEmptyState,children:[e(Ze,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e("h1",{className:S.chatEmptyStateTitle,children:"Chat with your data"}),e("h2",{className:S.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),e(Re,{onExampleClicked:ae})]}),e("div",{className:S.chatInput,children:e(xe,{clearOnSend:!0,placeholder:"输入问题",disabled:w,onSend:c=>P(c)})})]}),E.length>0&&$&&e(Ae,{className:S.chatAnalysisPanel,activeCitation:G,onActiveTabChanged:c=>K(c,j),citationHeight:"810px",answer:E[j][1],activeTab:$}),h(ye,{headerText:"配置",isOpen:t,isBlocking:!1,onDismiss:()=>o(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e(be,{onClick:()=>o(!1),children:"Close"}),isFooterAtBottom:!0,children:[e(z,{className:S.chatSettingsSeparator,defaultValue:a,label:"更改提问模板",multiline:!0,autoAdjustHeight:!0,onChange:Y}),e(Ne,{className:S.chatSettingsSeparator,label:"最多从搜索中返回的条目数量:",min:1,max:50,defaultValue:n.toString(),onChange:Z}),e(z,{className:S.chatSettingsSeparator,label:"排除类别",onChange:ne}),e(W,{className:S.chatSettingsSeparator,checked:p,label:"使用语义搜索",onChange:ee}),e(W,{className:S.chatSettingsSeparator,checked:r,label:"使用查询上下文摘要而不是整个文档",onChange:te,disabled:!p}),e(W,{className:S.chatSettingsSeparator,checked:v,label:"建议后续问题",onChange:oe})]})]})]})};et();tt();function qn(){return e(De,{children:e($e,{children:h(J,{path:"/",element:e(St,{}),children:[e(J,{index:!0,element:e(Dn,{})}),e(J,{path:"qa",element:e(gn,{})}),e(J,{path:"*",element:e(ft,{})})]})})})}Be.createRoot(document.getElementById("root")).render(e(Ie.StrictMode,{children:e(qn,{})}));
//# sourceMappingURL=index-8a2d432b.js.map
